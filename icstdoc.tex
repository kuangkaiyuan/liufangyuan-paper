% icstdoc.tex V1.12 6 May 2011

\documentclass{sig-alternate-05-2015}

%\usepackage{moreverb}
%
%\usepackage[breaklinks,colorlinks,bookmarksopen,bookmarksnumbered,linkcolor=ICSTblue,citecolor=blue,urlcolor=ICSTblue]{hyperref}
%\usepackage{breakurl}
%\usepackage{doi}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage{threeparttable}
\usepackage{listings}
\usepackage{color}
\usepackage{enumitem}
\usepackage[table]{xcolor}
\usepackage[english]{babel}
\usepackage{xspace}



\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
\definecolor{mygray}{gray}{.9}
\definecolor{mypink}{rgb}{.99,.91,.95}
\definecolor{mycyan}{cmyk}{.3,0,0,0}



\newcommand\FIXME[1]{\textcolor{red}{FIX:}\textcolor{red}{#1}}
\newcommand{\ToolName}{\textsc{DexPro}\xspace}


\begin{document}
\title{Bytecode Level Code Obfuscation for Android Applications}
\author{}

\maketitle

\begin{abstract}

%Reverse engineering is the necessary condition that Android application is
%repackaged or tampered. While obfuscation is widely known to increase the
%difficulty of reverse engineering. Current code obfuscation techniques mainly
%focus on the obfuscation on Java source code, however, it would not be
%applicable when the source code of applications is not provided by the
%developer. Besides, the attacker can successfully decompile an application
%that is protected by traditional code obfuscation techniques. This paper
%presents a protection method for Android apps based on obfuscation of smali
%code, which is the command language of Dalvik VM.
%Unauthorized code modification through reverse engineering is a major
%security thread for mobile users. Malicious apps are often implemented
%by changing the bytecode instructions of a normal app. By making the program
%difficult to analyze, code obfuscation is a potential solution for unauthorized code modification.
%The current code-obfuscation-based protection schemes often require having access to the high level
%source code (e.g. Java), making them infeasible to protect an already
%compiled application.  Given that mobile
%users often download applications from mirror app markets, there is a need
%for administrators of the official market (such as the Google Play Market) to
%protect a compiled source application against unauthorized modification and
%redistribution to mirror markets.
%This paper presents \ToolName, a novel bytecode level code obfuscation system for Android apps. Our approach targets the Android Dex bytecode format.
%\FIXME{I will need to know the novelty in order to continue}
%The basic idea is confusing
%the data-flow for the access procedure of constants within the registers, and
%combining opaque predicates technology to confuse the control-flow.
%Meanwhile, we also solved the problem of the register-type conflict when
%Dalvik VM executes the obfuscated apps. Thus when the attacker reversely
%analyzes the application, the decompiling results will be wrong. The
%obfuscation method is evaluated by potency, resilience and cost, and the
%experiment results show that the method can resist the reverse analysis of
%current popular reverse tools, such as jeb, dex2jar, dexdump and IDA pro.

Unauthorized code modification through reverse engineering is a major concern
for Android mobile app developers. This technique is often used by
adversaries to remove copyright protection or advertisements from the app, or
to inject malicious code into the program. By making the program difficult to
analyze, code obfuscation is a potential solution to the problem.
State-of-the-art code obfuscation schemes
often require having access to the source code. This requirement limits their application because developers often are reluctant to release their source code.

This paper presents \ToolName, a novel bytecode level code obfuscation system
for Android apps. Unlike prior approaches, our method peforms on the Android
Dex bytecode and does not require having access to high-level program source
code. Our approach exploits the two key structures of the Android Dex stack machine
 for to protect applications against static and dynamic code analysis. 
 To deter static analsysis, our approach leverages the fact all except floating
operands in Dex are stored in a 32-bit register, by packing two 32-bit
operands into a 64-bit operand. In this way, any attempt to decompile the
bytecode will result in wrong operands. To prevent dynamic analysis, we obfuscate the program
control flow by inserting opaque predicates before the return instruction of
a function call, so that the attacker will fail to trace calls to protected functions. These two techniques, putting together, enable us to
build a new, more powerful
byte-code level protection scheme for Android applications. 
Experimental results show that our approach can deter sophisticate reverse engineering and code analysis tools and the runtime overhead is comparable to state-of-the-art source code level code obfuscation schemes.


\end{abstract}


\begin{CCSXML}
<ccs2012>
<concept>
<concept_id>10002978.10002991.10002992.10011618</concept_id>
<concept_desc>Security and privacy~Graphical / visual passwords</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10002978.10003014.10003017</concept_id>
<concept_desc>Security and privacy~Mobile and wireless security</concept_desc>
<concept_significance>300</concept_significance>
</concept>
</ccs2012>
\end{CCSXML}


\input{introduction}
\input{background}
\input{overview}
\input{evaluation}
\input{relatedwork}
\input{conclusion}
\input{acknowledge}

\bibliographystyle{abbrv}
\bibliography{reference}

\end{document}
